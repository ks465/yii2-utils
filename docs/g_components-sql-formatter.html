<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="language" content="en" />
        <link href="./assets/b01f69f9/css/bootstrap.css" rel="stylesheet">
<link href="./assets/9af5cddc/solarized_light.css" rel="stylesheet">
<link href="./assets/47da18fa/style.css" rel="stylesheet">
<script src="./assets/e36a8b07/jquery.js"></script>
<script src="./assets/b01f69f9/js/bootstrap.js"></script>
<script src="./assets/b3d3834e/jssearch.js"></script>    <title>SqlFormatter - Others - KHanUtilsGuide</title>
</head>
<body>

<div class="wrap">
    <nav id="w119" class="navbar-inverse navbar-fixed-top navbar"><div class="navbar-header"><button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#w119-collapse"><span class="sr-only">Toggle navigation</span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span></button><a class="navbar-brand" href="./guide-index.html">KHanUtilsGuide</a></div><div id="w119-collapse" class="collapse navbar-collapse"><ul id="w120" class="navbar-nav nav"><li><a href="./g_README.html">Guide</a></li></ul><div class="navbar-form navbar-left" role="search">
  <div class="form-group">
    <input id="searchbox" type="text" class="form-control" placeholder="Search">
  </div>
</div>
</div></nav>
    <div id="search-resultbox" style="display: none;" class="modal-content">
        <ul id="search-results">
        </ul>
    </div>

    
<div class="row">
    <div class="col-md-2">
                <div id="navigation" class="list-group"><a class="list-group-item" href="#navigation-110" data-toggle="collapse" data-parent="#navigation">Documentation <b class="caret"></b></a><div id="navigation-110" class="submenu panel-collapse collapse"><a class="list-group-item" href="./g_documents.html">Document Tips and Tricks</a></div>
<a class="list-group-item active" href="#navigation-111" data-toggle="collapse" data-parent="#navigation">Components <b class="caret"></b></a><div id="navigation-111" class="submenu panel-collapse collapse in"><a class="list-group-item" href="./g_components-array-helper.html">Array Helper</a>
<a class="list-group-item" href="./g_components-file-helper.html">File Helper</a>
<a class="list-group-item" href="./g_components-jalali.html">Jalali and JalaliX</a>
<a class="list-group-item" href="./g_components-math-helper.html">Math Helper</a>
<a class="list-group-item active" href="./g_components-sql-formatter.html">SQL Formatter</a>
<a class="list-group-item" href="./g_components-string-helper.html">String Helper</a>
<a class="list-group-item" href="./g_components-view-helper.html">View Helper</a></div>
<a class="list-group-item" href="#navigation-112" data-toggle="collapse" data-parent="#navigation">Columns <b class="caret"></b></a><div id="navigation-112" class="submenu panel-collapse collapse"><a class="list-group-item" href="./g_columns-action-column.html">Action Column</a>
<a class="list-group-item" href="./g_columns-data-column.html">Data Column</a></div>
<a class="list-group-item" href="#navigation-113" data-toggle="collapse" data-parent="#navigation">Models <b class="caret"></b></a><div id="navigation-113" class="submenu panel-collapse collapse"><a class="list-group-item" href="./g_models-khan-model.html">Base Model</a>
<a class="list-group-item" href="./g_models-khan-user.html">Base user</a></div>
<a class="list-group-item" href="#navigation-114" data-toggle="collapse" data-parent="#navigation">RBAC <b class="caret"></b></a><div id="navigation-114" class="submenu panel-collapse collapse"><a class="list-group-item" href="./g_rbac-rule-owner.html">Owner Rule</a></div>
<a class="list-group-item active" href="#navigation-115" data-toggle="collapse" data-parent="#navigation">Others <b class="caret"></b></a><div id="navigation-115" class="submenu panel-collapse collapse in"><a class="list-group-item" href="./g_components-var-dump.html">VarDump</a>
<a class="list-group-item active" href="./g_components-sql-formatter.html">SqlFormatter</a>
<a class="list-group-item" href="./g_settings.html">Settings</a>
<a class="list-group-item" href="./g_helpers-migrations.html">Migrations</a>
<a class="list-group-item" href="./g_widgets-menu.html">Overlay Menu</a></div>
<a class="list-group-item" href="#navigation-116" data-toggle="collapse" data-parent="#navigation">StartUp <b class="caret"></b></a><div id="navigation-116" class="submenu panel-collapse collapse"></div>
<a class="list-group-item" href="#navigation-117" data-toggle="collapse" data-parent="#navigation">Sanitizing User Input <b class="caret"></b></a><div id="navigation-117" class="submenu panel-collapse collapse"></div>
<a class="list-group-item" href="#navigation-118" data-toggle="collapse" data-parent="#navigation">RBAC Setup <b class="caret"></b></a><div id="navigation-118" class="submenu panel-collapse collapse"></div></div>    </div>
    <div class="col-md-9 guide-content" role="main">
        <h1>SqlFormatter Class <span id="sqlformatter-class"></span><a href="#sqlformatter-class" class="hashlink">&para;</a></h1><p>This class is a third party Object. It is capable of producing well formatted SQL statements with coloring.
The coloring is available in CLI and web. There is no need to do anything special to recognize the environment.
Obviously if the CLI environment is not capable of highlighting, the output is in plain normal text. But there is no
error or problem.</p>
<p><em><strong>Because this is a third party class, there is no unit test for this class.</strong> For examples see the demo section.</em></p>
<p><em><strong>There is no need to call methods in this class directly. Just use <code>explain</code> or <code>xd</code> as following examples show.</strong></em></p>
<ol>
<li><code>explain</code> Show a formatted text of an SQL query.</li>
<li><code>xd</code> Show a formatted text of an SQL query. This method will stop your script after the dump.</li>
</ol>
<pre><code class="hljs php language-php"><span class="hljs-variable">$sql</span> = KHanModel::find()
    -&gt;andWhere([<span class="hljs-string">'i'</span> =&gt; <span class="hljs-number">1</span>])
    -&gt;groupBy([<span class="hljs-string">'x'</span>])
    -&gt;having([<span class="hljs-string">'&gt;'</span>, <span class="hljs-string">'z'</span>, <span class="hljs-number">1</span>])
    -&gt;orderBy([<span class="hljs-string">'alpha'</span> =&gt; SORT_ASC])
    -&gt;createCommand()-&gt;rawSql;

<span class="hljs-keyword">echo</span>(<span class="hljs-variable">$sql</span>); <span class="hljs-comment">//This result in no coloring in CLI or web:</span>
<span class="hljs-comment">//SELECT * FROM `khan_model` WHERE `i`=1 GROUP BY `x` HAVING `z` &gt; 1 ORDER BY `alpha`</span>

<span class="hljs-keyword">echo</span> SqlFormatter::format(<span class="hljs-variable">$sql</span>); <span class="hljs-comment">//The output is highlighted in both web and CLI.</span>
<span class="hljs-comment">/*
SELECT 
  * 
FROM 
  `khan_model` 
WHERE 
  `i` = 1 
GROUP BY 
  `x` 
HAVING 
  `z` &gt; 1 
ORDER BY 
  `alpha`
 */</span>
</code></pre>
<p>For simplicity you can use <code>explain</code> or <code>xp</code> for this purpose:</p>
<pre><code class="hljs php language-php">explain(<span class="hljs-variable">$sql</span>); <span class="hljs-comment">//shows the calling file name and line. Then continue the script.</span>

<span class="hljs-comment">/*
path/to/calling/file:lineNumber

SELECT 
  * 
FROM 
  `khan_model` 
WHERE 
  `i` = 1 
GROUP BY 
  `x` 
HAVING 
  `z` &gt; 1 
ORDER BY 
  `alpha`
 */</span>
xd(<span class="hljs-variable">$sql</span>); <span class="hljs-comment">//this has the same output. But stops the script afterward.</span>
</code></pre>
        <div class="toplink"><a href="#" class="h1" title="go to top"><span class="glyphicon glyphicon-arrow-up"></a></div>
    </div>
</div>


</div>

<footer class="footer">
        <p class="pull-right"><small>Page generated on Sun, 11 Nov 2018 17:01:27 +0000</small></p>
    Powered by <a href="http://www.yiiframework.com/" rel="external">Yii Framework</a></footer>

<script>jQuery(function ($) {
    var shiftWindow = function () { scrollBy(0, -50) };
    if (location.hash) setTimeout(shiftWindow, 1);
    window.addEventListener("hashchange", shiftWindow);
var element = document.createElement("script");
element.src = "./jssearch.index.js";
document.body.appendChild(element);

var searchBox = $('#searchbox');

// search when typing in search field
searchBox.on("keyup", function(event) {
    var query = $(this).val();

    if (query == '' || event.which == 27) {
        $('#search-resultbox').hide();
        return;
    } else if (event.which == 13) {
        var selectedLink = $('#search-resultbox a.selected');
        if (selectedLink.length != 0) {
            document.location = selectedLink.attr('href');
            return;
        }
    } else if (event.which == 38 || event.which == 40) {
        $('#search-resultbox').show();

        var selected = $('#search-resultbox a.selected');
        if (selected.length == 0) {
            $('#search-results').find('a').first().addClass('selected');
        } else {
            var next;
            if (event.which == 40) {
                next = selected.parent().next().find('a').first();
            } else {
                next = selected.parent().prev().find('a').first();
            }
            if (next.length != 0) {
                var resultbox = $('#search-results');
                var position = next.position();

//              TODO scrolling is buggy and jumps around
//                resultbox.scrollTop(Math.floor(position.top));
//                console.log(position.top);

                selected.removeClass('selected');
                next.addClass('selected');
            }
        }

        return;
    }
    $('#search-resultbox').show();
    $('#search-results').html('<li><span class="no-results">No results</span></li>');

    var result = jssearch.search(query);

    if (result.length > 0) {
        var i = 0;
        var resHtml = '';

        for (var key in result) {
            if (i++ > 20) {
                break;
            }
            resHtml = resHtml +
            '<li><a href="' + result[key].file.u.substr(3) +'"><span class="title">' + result[key].file.t + '</span>' +
            '<span class="description">' + result[key].file.d + '</span></a></li>';
        }
        $('#search-results').html(resHtml);
    }
});

// hide the search results on ESC
$(document).on("keyup", function(event) { if (event.which == 27) { $('#search-resultbox').hide(); } });
// hide search results on click to document
$(document).bind('click', function (e) { $('#search-resultbox').hide(); });
// except the following:
searchBox.bind('click', function(e) { e.stopPropagation(); });
$('#search-resultbox').bind('click', function(e) { e.stopPropagation(); });

});</script></body>
</html>
